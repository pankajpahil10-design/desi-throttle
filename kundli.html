<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nayki Jyotish â€” Kundli Calculator</title>
<style>
body { font-family: 'Segoe UI', sans-serif; background: #0a0a1a; color: #e0e0e0; padding: 2rem; line-height: 1.6; }
h1 { color: #8888cc; text-align: center; }
h2 { color: #6666aa; border-bottom: 1px solid #333; padding-bottom: 5px; }
table { border-collapse: collapse; width: 100%; margin: 1rem 0; }
th, td { border: 1px solid #333; padding: 8px 12px; text-align: left; }
th { background: #1a1a3e; color: #8888cc; }
tr:hover { background: rgba(255,255,255,0.05); }
.info { color: #aaa; font-size: 0.9em; }
#output { white-space: pre-wrap; }
</style>
</head>
<body>
<h1>ğŸ•‰ï¸ Nayki Jyotish â€” Kundli Calculator</h1>
<div id="output"></div>

<script>
// ====== ASTRONOMICAL CALCULATIONS (Jean Meeus - Astronomical Algorithms) ======

function julianDay(Y, M, D, UT) {
    if (M <= 2) { Y--; M += 12; }
    var A = Math.floor(Y / 100);
    var B = 2 - A + Math.floor(A / 4);
    return Math.floor(365.25 * (Y + 4716)) + Math.floor(30.6001 * (M + 1)) + D + UT/24.0 + B - 1524.5;
}

function degSin(d) { return Math.sin(d * Math.PI / 180); }
function degCos(d) { return Math.cos(d * Math.PI / 180); }
function degTan(d) { return Math.tan(d * Math.PI / 180); }
function degAsin(x) { return Math.asin(x) * 180 / Math.PI; }
function degAtan2(y, x) { return Math.atan2(y, x) * 180 / Math.PI; }
function mod360(x) { return ((x % 360) + 360) % 360; }

// Lahiri Ayanamsa
function lahiriAyanamsa(jd) {
    var T = (jd - 2451545.0) / 36525.0;
    // Lahiri ayanamsa: based on Spica at 0Â° Libra in 285 AD
    return 23.85 + 0.013971 * (jd - 2451545.0) / 365.25;
}

// Sun longitude (Meeus Chapter 25)
function sunLongitude(jd) {
    var T = (jd - 2451545.0) / 36525.0;
    var L0 = mod360(280.46646 + 36000.76983 * T + 0.0003032 * T * T);
    var M = mod360(357.52911 + 35999.05029 * T - 0.0001537 * T * T);
    var C = (1.914602 - 0.004817 * T) * degSin(M) + (0.019993 - 0.000101 * T) * degSin(2 * M) + 0.000289 * degSin(3 * M);
    var sunLon = mod360(L0 + C);
    // Aberration correction
    var omega = 125.04 - 1934.136 * T;
    sunLon = sunLon - 0.00569 - 0.00478 * degSin(omega);
    return mod360(sunLon);
}

// Moon longitude (Meeus Chapter 47 - simplified)
function moonLongitude(jd) {
    var T = (jd - 2451545.0) / 36525.0;
    var Lp = mod360(218.3165 + 481267.8813 * T);
    var D = mod360(297.8502 + 445267.1115 * T);
    var M = mod360(357.5291 + 35999.0503 * T);
    var Mp = mod360(134.9634 + 477198.8676 * T);
    var F = mod360(93.2720 + 483202.0175 * T);

    var lon = Lp
        + 6.289 * degSin(Mp)
        + 1.274 * degSin(2 * D - Mp)
        + 0.658 * degSin(2 * D)
        + 0.214 * degSin(2 * Mp)
        - 0.186 * degSin(M)
        - 0.114 * degSin(2 * F)
        + 0.059 * degSin(2 * D - 2 * Mp)
        + 0.057 * degSin(2 * D - M - Mp)
        + 0.053 * degSin(2 * D + Mp)
        + 0.046 * degSin(2 * D - M)
        - 0.041 * degSin(Mp - M)
        - 0.035 * degSin(D)
        - 0.031 * degSin(Mp + M)
        + 0.015 * degSin(2 * D - 2 * F)
        + 0.011 * degSin(2 * D - Mp - M);
    return mod360(lon);
}

// Planetary longitudes using simplified orbital elements (Meeus Table 31.A)
function planetLongitude(jd, planet) {
    var T = (jd - 2451545.0) / 36525.0;
    var elements = {
        'Mercury': { L: [252.2509, 149474.0722], a: 0.387098, e: [0.205635, 0.000023], i: [7.0050, 0.0019], w: [77.4561, 1.5564], O: [48.3309, 1.1862] },
        'Venus':   { L: [181.9798, 58519.2130], a: 0.723330, e: [0.006773, -0.000048], i: [3.3947, 0.0010], w: [131.5637, 1.4022], O: [76.6799, 0.9011] },
        'Mars':    { L: [355.4330, 19141.6964], a: 1.523688, e: [0.093405, 0.000090], i: [1.8497, -0.0007], w: [336.0602, 1.8410], O: [49.5574, 0.7721] },
        'Jupiter': { L: [34.3515, 3036.3027], a: 5.202561, e: [0.048498, 0.000163], i: [1.3033, -0.0020], w: [14.3312, 1.6126], O: [100.4644, 1.0210] },
        'Saturn':  { L: [50.0774, 1223.5110], a: 9.554747, e: [0.055546, -0.000346], i: [2.4889, 0.0025], w: [93.0572, 1.9584], O: [113.6634, 0.8770] },
    };

    var p = elements[planet];
    if (!p) return 0;

    var L = mod360(p.L[0] + p.L[1] * T);
    var e = p.e[0] + p.e[1] * T;
    var w = mod360(p.w[0] + p.w[1] * T);

    var M = mod360(L - w);
    // Solve Kepler's equation iteratively
    var E = M;
    for (var i = 0; i < 10; i++) {
        E = M + (180 / Math.PI) * e * degSin(E);
    }

    var xv = degCos(E) - e;
    var yv = Math.sqrt(1 - e * e) * degSin(E);
    var v = mod360(degAtan2(yv, xv));
    var lon = mod360(v + w);

    return lon;
}

// Rahu (Mean North Node)
function rahuLongitude(jd) {
    var T = (jd - 2451545.0) / 36525.0;
    return mod360(125.0446 - 1934.1363 * T + 0.0021 * T * T);
}

// Ascendant (Lagna)
function calcAscendant(jd, lat, lon) {
    var T = (jd - 2451545.0) / 36525.0;
    // Greenwich Sidereal Time
    var GST = mod360(280.46061837 + 360.98564736629 * (jd - 2451545.0) + 0.000387933 * T * T);
    // Local Sidereal Time
    var LST = mod360(GST + lon);
    // Obliquity of ecliptic
    var eps = 23.4393 - 0.0130 * T;
    // Ascendant formula
    var ascNum = -degCos(LST);
    var ascDen = degSin(LST) * degCos(eps) + degTan(lat) * degSin(eps);
    var asc = mod360(degAtan2(ascNum, ascDen));
    return asc;
}

// ====== VEDIC ASTROLOGY MAPPINGS ======

var SIGNS = ['Mesha (Aries)', 'Vrishabha (Taurus)', 'Mithuna (Gemini)', 'Karka (Cancer)',
             'Simha (Leo)', 'Kanya (Virgo)', 'Tula (Libra)', 'Vrishchik (Scorpio)',
             'Dhanu (Sagittarius)', 'Makara (Capricorn)', 'Kumbha (Aquarius)', 'Meena (Pisces)'];

var SIGN_LORDS = ['Mars', 'Venus', 'Mercury', 'Moon', 'Sun', 'Mercury', 'Venus', 'Mars', 'Jupiter', 'Saturn', 'Saturn', 'Jupiter'];

var NAKSHATRAS = [
    {name: 'Ashwini', lord: 'Ketu', deity: 'Ashwini Kumaras', gana: 'Deva'},
    {name: 'Bharani', lord: 'Venus', deity: 'Yama', gana: 'Manushya'},
    {name: 'Krittika', lord: 'Sun', deity: 'Agni', gana: 'Rakshasa'},
    {name: 'Rohini', lord: 'Moon', deity: 'Brahma', gana: 'Manushya'},
    {name: 'Mrigashira', lord: 'Mars', deity: 'Soma', gana: 'Deva'},
    {name: 'Ardra', lord: 'Rahu', deity: 'Rudra', gana: 'Manushya'},
    {name: 'Punarvasu', lord: 'Jupiter', deity: 'Aditi', gana: 'Deva'},
    {name: 'Pushya', lord: 'Saturn', deity: 'Brihaspati', gana: 'Deva'},
    {name: 'Ashlesha', lord: 'Mercury', deity: 'Nagas', gana: 'Rakshasa'},
    {name: 'Magha', lord: 'Ketu', deity: 'Pitrs', gana: 'Rakshasa'},
    {name: 'Purva Phalguni', lord: 'Venus', deity: 'Bhaga', gana: 'Manushya'},
    {name: 'Uttara Phalguni', lord: 'Sun', deity: 'Aryaman', gana: 'Manushya'},
    {name: 'Hasta', lord: 'Moon', deity: 'Savitar', gana: 'Deva'},
    {name: 'Chitra', lord: 'Mars', deity: 'Vishwakarma', gana: 'Rakshasa'},
    {name: 'Swati', lord: 'Rahu', deity: 'Vayu', gana: 'Deva'},
    {name: 'Vishakha', lord: 'Jupiter', deity: 'Indra-Agni', gana: 'Rakshasa'},
    {name: 'Anuradha', lord: 'Saturn', deity: 'Mitra', gana: 'Deva'},
    {name: 'Jyeshtha', lord: 'Mercury', deity: 'Indra', gana: 'Rakshasa'},
    {name: 'Mula', lord: 'Ketu', deity: 'Nirriti', gana: 'Rakshasa'},
    {name: 'Purva Ashadha', lord: 'Venus', deity: 'Apas', gana: 'Manushya'},
    {name: 'Uttara Ashadha', lord: 'Sun', deity: 'Vishvedevas', gana: 'Manushya'},
    {name: 'Shravana', lord: 'Moon', deity: 'Vishnu', gana: 'Deva'},
    {name: 'Dhanishtha', lord: 'Mars', deity: 'Vasus', gana: 'Rakshasa'},
    {name: 'Shatabhisha', lord: 'Rahu', deity: 'Varuna', gana: 'Rakshasa'},
    {name: 'Purva Bhadrapada', lord: 'Jupiter', deity: 'Aja Ekapada', gana: 'Manushya'},
    {name: 'Uttara Bhadrapada', lord: 'Saturn', deity: 'Ahir Budhnya', gana: 'Manushya'},
    {name: 'Revati', lord: 'Mercury', deity: 'Pushan', gana: 'Deva'}
];

var DASHA_ORDER = ['Ketu', 'Venus', 'Sun', 'Moon', 'Mars', 'Rahu', 'Jupiter', 'Saturn', 'Mercury'];
var DASHA_YEARS = [7, 20, 6, 10, 7, 18, 16, 19, 17]; // total 120

function getSign(sidLon) { return Math.floor(sidLon / 30); }
function getDegInSign(sidLon) { return sidLon % 30; }
function getNakshatra(sidLon) { return Math.floor(sidLon / (360/27)); }
function getPada(sidLon) {
    var nakDeg = sidLon % (360/27);
    return Math.floor(nakDeg / (360/108)) + 1;
}

function formatDMS(deg) {
    var d = Math.floor(deg);
    var m = Math.floor((deg - d) * 60);
    var s = Math.floor(((deg - d) * 60 - m) * 60);
    return d + 'Â°' + (m < 10 ? '0' : '') + m + "'" + (s < 10 ? '0' : '') + s + '"';
}

// ====== CALCULATE KUNDLI ======

// Birth data: Pankaj Pahil, 10 Aug 1988, 13:20 IST, Rohini Delhi
var name = "Pankaj Pahil";
var father = "S/o Baljit Singh";
var dob = "10 August 1988 (Wednesday)";
var tob = "13:20 IST (1:20 PM)";
var pob = "Rohini, New Delhi, India";
var lat = 28.7495;
var lon = 77.0723;

// Convert IST to UT: IST = UT + 5:30, so UT = 13:20 - 5:30 = 7:50
var UT = 7 + 50/60.0;
var jd = julianDay(1988, 8, 10, UT);
var ayanamsa = lahiriAyanamsa(jd);

// Calculate tropical longitudes
var sunTrop = sunLongitude(jd);
var moonTrop = moonLongitude(jd);
var marsTrop = planetLongitude(jd, 'Mars');
var mercTrop = planetLongitude(jd, 'Mercury');
var jupTrop = planetLongitude(jd, 'Jupiter');
var venTrop = planetLongitude(jd, 'Venus');
var satTrop = planetLongitude(jd, 'Saturn');
var rahuTrop = rahuLongitude(jd);
var ketuTrop = mod360(rahuTrop + 180);
var ascTrop = calcAscendant(jd, lat, lon);

// Convert to sidereal
var sunSid = mod360(sunTrop - ayanamsa);
var moonSid = mod360(moonTrop - ayanamsa);
var marsSid = mod360(marsTrop - ayanamsa);
var mercSid = mod360(mercTrop - ayanamsa);
var jupSid = mod360(jupTrop - ayanamsa);
var venSid = mod360(venTrop - ayanamsa);
var satSid = mod360(satTrop - ayanamsa);
var rahuSid = mod360(rahuTrop - ayanamsa);
var ketuSid = mod360(ketuTrop - ayanamsa);
var ascSid = mod360(ascTrop - ayanamsa);

// Build output
var out = '';
out += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
out += 'ğŸ•‰ï¸  JANAM KUNDLI â€” ' + name.toUpperCase() + '\n';
out += '    ' + father + '\n';
out += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n';
out += 'ğŸ“‹ BIRTH DETAILS\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Name:           ' + name + '\n';
out += 'Father:         ' + father + '\n';
out += 'Date of Birth:  ' + dob + '\n';
out += 'Time of Birth:  ' + tob + '\n';
out += 'Place of Birth: ' + pob + '\n';
out += 'Coordinates:    ' + lat + 'Â°N, ' + lon + 'Â°E\n';
out += 'Julian Day:     ' + jd.toFixed(4) + '\n';
out += 'Ayanamsa:       Lahiri ' + formatDMS(ayanamsa) + '\n\n';

out += 'ğŸª PLANETARY POSITIONS (Sidereal â€” Lahiri)\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';

var planets = [
    {name: 'Lagna (Asc)', sid: ascSid},
    {name: 'Sun â˜€ï¸', sid: sunSid},
    {name: 'Moon ğŸŒ™', sid: moonSid},
    {name: 'Mars â™‚ï¸', sid: marsSid},
    {name: 'Mercury â˜¿ï¸', sid: mercSid},
    {name: 'Jupiter â™ƒ', sid: jupSid},
    {name: 'Venus â™€ï¸', sid: venSid},
    {name: 'Saturn â™„', sid: satSid},
    {name: 'Rahu â˜Š', sid: rahuSid},
    {name: 'Ketu â˜‹', sid: ketuSid}
];

out += 'Planet'.padEnd(16) + 'Rashi'.padEnd(24) + 'Degree'.padEnd(12) + 'Nakshatra'.padEnd(22) + 'Pada\n';
out += 'â”€'.repeat(80) + '\n';

planets.forEach(function(p) {
    var sign = getSign(p.sid);
    var deg = getDegInSign(p.sid);
    var nak = getNakshatra(p.sid);
    var pada = getPada(p.sid);
    out += p.name.padEnd(16) + SIGNS[sign].padEnd(24) + formatDMS(deg).padEnd(12) + NAKSHATRAS[nak].name.padEnd(22) + pada + '\n';
});

out += '\n';

// Moon details for Dasha
var moonSign = getSign(moonSid);
var moonNak = getNakshatra(moonSid);
var moonPada = getPada(moonSid);

out += 'ğŸŒ™ RASHI & NAKSHATRA\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Moon Sign (Rashi):    ' + SIGNS[moonSign] + '\n';
out += 'Birth Nakshatra:      ' + NAKSHATRAS[moonNak].name + ' (Pada ' + moonPada + ')\n';
out += 'Nakshatra Lord:       ' + NAKSHATRAS[moonNak].lord + '\n';
out += 'Nakshatra Deity:      ' + NAKSHATRAS[moonNak].deity + '\n';
out += 'Gana:                 ' + NAKSHATRAS[moonNak].gana + '\n';
out += 'Lagna Sign:           ' + SIGNS[getSign(ascSid)] + '\n';
out += 'Lagna Lord:           ' + SIGN_LORDS[getSign(ascSid)] + '\n\n';

// Vimshottari Dasha calculation
var nakLord = NAKSHATRAS[moonNak].lord;
var dashaStartIdx = DASHA_ORDER.indexOf(nakLord);
var nakStart = moonNak * (360/27);
var moonInNak = moonSid - nakStart;
var nakSize = 360/27;
var traversed = moonInNak / nakSize;
var remaining = 1 - traversed;
var remainYears = remaining * DASHA_YEARS[dashaStartIdx];

out += 'â³ VIMSHOTTARI DASHA\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Starting Dasha Lord:  ' + nakLord + '\n';
out += 'Balance at Birth:     ' + remainYears.toFixed(2) + ' years\n\n';

var birthYear = 1988 + (222/365); // Aug 10
var currentYear = birthYear;
currentYear += remainYears;

out += 'Mahadasha'.padEnd(16) + 'From'.padEnd(12) + 'To'.padEnd(12) + 'Duration\n';
out += 'â”€'.repeat(52) + '\n';

// First partial dasha
var startYr = Math.floor(1988 + (222/365));
var endYr = Math.floor(birthYear + remainYears);
out += (nakLord + ' *').padEnd(16) + ('~' + startYr).padEnd(12) + ('~' + endYr).padEnd(12) + remainYears.toFixed(1) + ' yrs (balance)\n';

for (var d = 1; d <= 9; d++) {
    var idx = (dashaStartIdx + d) % 9;
    var fromYr = Math.floor(currentYear);
    currentYear += DASHA_YEARS[idx];
    var toYr = Math.floor(currentYear);
    var marker = '';
    if (fromYr <= 2026 && toYr >= 2026) marker = ' â—€ CURRENT';
    out += DASHA_ORDER[idx].padEnd(16) + ('~' + fromYr).padEnd(12) + ('~' + toYr).padEnd(12) + DASHA_YEARS[idx] + ' yrs' + marker + '\n';
}

out += '\n';

// Manglik check
var marsHouse = ((getSign(marsSid) - getSign(ascSid)) + 12) % 12 + 1;
var manglik = [1, 2, 4, 7, 8, 12].indexOf(marsHouse) >= 0;
out += 'ğŸ”´ MANGLIK CHECK\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Mars in House:  ' + marsHouse + ' from Lagna\n';
out += 'Manglik:        ' + (manglik ? 'YES âš ï¸' : 'NO âœ…') + '\n\n';

// Summary
out += 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n';
out += 'ğŸ“Š CALCULATION DETAILS\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Algorithm:  Jean Meeus - Astronomical Algorithms\n';
out += 'Ayanamsa:   Lahiri (Chitrapaksha)\n';
out += 'House Sys:  Whole Sign\n';
out += 'Node:       Mean Node (Rahu)\n';
out += 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n';
out += 'Built with â¤ï¸ by Nayki & Pekay\n';
out += 'ğŸ•‰ï¸ OM\n';

document.getElementById('output').textContent = out;
</script>
</body>
</html>
